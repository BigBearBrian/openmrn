VPATH := $(SRCDIR): \
         $(SRCDIR)/common \

CSRCS += fileio.c \
         can.c \
         serial.c \

CXXSRCS += Fileio.cxx \
           Can.cxx \
           Serial.cxx

ifeq ($(TARGET),freertos.armv7m)
CXXSRCS += c++_operators.cxx
endif

# Find StellarisWare
ifdef STELLARISWAREPATH
ifeq ($(TARGET),freertos.armv7m)
include $(OPENMRNPATH)/etc/stellarisware.mk

CXXSRCS += StellarisCan.cxx \
           StellarisUart.cxx \
           StellarisUsbCdcDevice.cxx

VPATH += $(SRCDIR)/stellarisware
endif
endif

ifdef HAVE_MBED
ifneq ($(TARGET),freertos.armv6m)
CPPSRCS += mbed_can.cpp mbed_usbserial.cpp
endif
ARM_CSRCS += i2c_irq.c  # mbed_i2c.c

VPATH += $(SRCDIR)/nxp
endif

# NOTE(balazs.racz): This is ugly, because we add a driver of a specific MCU
# depending on the general CPU architecture.
ifeq ($(TARGET),freertos.armv6m)
CSRCS += 11CXX_rom_can.c # malloc.c
CXXSRCS += 11cxx_async_can.cxx
VPATH += $(SRCDIR)/nxp
endif


ifeq ($(TARGET),freertos.mips4k.pic32mx)

CSRCS += pic32mx_can.c

VPATH += $(SRCDIR)/pic32mx

endif
